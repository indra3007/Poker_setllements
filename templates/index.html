<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ° Poker Tracker</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='icon.png') }}">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <h1>ğŸ° Poker Tracker</h1>
            <p class="subtitle">Track chips, calculate settlements</p>
        </header>

        <!-- Tab Navigation -->
        <div class="tabs">
            <button class="tab active" data-tab="players">ğŸ‘¥ Players</button>
            <button class="tab" data-tab="settlements">ğŸ’° Settlements</button>
            <button class="tab" data-tab="charts">ğŸ“Š Charts</button>
        </div>

        <!-- Players Tab -->
        <div id="players-tab" class="tab-content active">
            <!-- Event Selection -->
            <div class="event-selector">
                <div class="event-controls">
                    <label for="event-select">ğŸ¯ Event:</label>
                    <select id="event-select" class="event-dropdown">
                        <option value="">-- Select Event --</option>
                    </select>
                    <button class="btn btn-secondary" id="new-event">+ New Event</button>
                </div>
            </div>

            <!-- Quick Add Players -->
            <div class="quick-add-section">
                <label class="quick-add-label">ğŸ‘¥ Quick Add Players:</label>
                <div class="player-chips">
                    <button class="player-chip" data-name="Indraneel">Indraneel</button>
                    <button class="player-chip" data-name="Gnathi">Gnathi</button>
                    <button class="player-chip" data-name="Rupesh">Rupesh</button>
                    <button class="player-chip" data-name="Sindhu">Sindhu</button>
                    <button class="player-chip" data-name="Umesh">Umesh</button>
                    <button class="player-chip" data-name="Radhika">Radhika</button>
                    <button class="player-chip" data-name="Dileesh">Dileesh</button>
                    <button class="player-chip" data-name="Deeraj">Deeraj</button>
                </div>
                <div class="custom-player-input">
                    <input type="text" id="custom-player-name" placeholder="Or enter new player name..." />
                    <button class="btn btn-small btn-primary" id="add-custom-player">+ Add</button>
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-success" id="save-data">ğŸ’¾ Save</button>
                <button class="btn btn-danger" id="clear-data">ğŸ—‘ï¸ Clear Event</button>
            </div>

            <div class="table-container">
                <table id="players-table" class="players-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Phone</th>
                            <th>Start $</th>
                            <th>Buy-ins</th>
                            <th>Day 1</th>
                            <th>Day 2</th>
                            <th>Day 3</th>
                            <th>Day 4</th>
                            <th>Day 5</th>
                            <th>Day 6</th>
                            <th>Day 7</th>
                            <th>P/L</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="players-tbody">
                        <!-- Players will be dynamically added here -->
                    </tbody>
                    <tfoot>
                        <tr class="total-row">
                            <td colspan="3"><strong>TOTALS</strong></td>
                            <td id="total-buyins">0</td>
                            <td id="total-day1">$0</td>
                            <td id="total-day2">$0</td>
                            <td id="total-day3">$0</td>
                            <td id="total-day4">$0</td>
                            <td id="total-day5">$0</td>
                            <td id="total-day6">$0</td>
                            <td id="total-day7">$0</td>
                            <td id="total-pl">$0</td>
                            <td></td>
                        </tr>
                    </tfoot>
                </table>
            </div>

            <div class="summary-box">
                <h3>ğŸ“Š Summary</h3>
                <div class="summary-grid">
                    <div class="summary-item">
                        <span class="label">Total Players:</span>
                        <span class="value" id="total-players">0</span>
                    </div>
                    <div class="summary-item">
                        <span class="label">Total Profit:</span>
                        <span class="value positive" id="total-profit">$0</span>
                    </div>
                    <div class="summary-item">
                        <span class="label">Total Loss:</span>
                        <span class="value negative" id="total-loss">$0</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settlements Tab -->
        <div id="settlements-tab" class="tab-content">
            <div class="action-buttons">
                <button class="btn btn-primary" id="calculate-settlements">ğŸ”„ Calculate</button>
            </div>

            <div id="settlements-container">
                <div class="info-box">
                    <p>ğŸ’¡ Click "Calculate" to see who pays whom</p>
                    <p>The algorithm minimizes the number of transactions needed</p>
                </div>
            </div>
        </div>

        <!-- Charts Tab -->
        <div id="charts-tab" class="tab-content">
            <div class="action-buttons">
                <button class="btn btn-primary" id="refresh-charts">ğŸ”„ Refresh Charts</button>
            </div>

            <div id="charts-container">
                <canvas id="profit-loss-chart" style="max-height: 300px; margin-bottom: 20px;"></canvas>
                <canvas id="chips-trend-chart" style="max-height: 300px;"></canvas>
            </div>
        </div>

        <!-- Footer -->
        <footer>
            <p>Made with â¤ï¸ for poker nights</p>
        </footer>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="spinner"></div>
        <p>Loading...</p>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast hidden"></div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
